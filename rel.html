<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>æˆ‘çš„äººé™…å…³ç³»ç½‘ç»œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet" />
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <link rel="stylesheet" href="css/rel.css" />
  
</head>
<body>
  <div class="layout">
    <!-- å¯¼èˆªæ  -->
    <nav class="sidebar">
      <h2>å¯¼èˆª</h2>
      <ul class="nav-links">
        <li><a href="index.html"><i class="ri-home-4-line"></i> é¦–é¡µ</a></li>
        <li><a href="profile.html"><i class="ri-user-3-line"></i> ä¸ªäººç®€å†</a></li>
        <li><a href="rel.html" class="active"><i class="ri-group-line"></i> äººé™…å…³ç³»</a></li>
        <li><a href="score.html"><i class="ri-bar-chart-2-line"></i> å¤§å­¦æˆç»©</a></li>
        <li><a href="school.html"><i class="ri-graduation-cap-line"></i> æˆ‘çš„å¤§å­¦</a></li>
        <li><a href="home.html"><i class="ri-landscape-line"></i> æˆ‘çš„å®¶ä¹¡</a></li>
      </ul>
    </nav>
    <main class="main">
      <h1><i class="ri-group-line"></i> æˆ‘çš„ç¤¾äº¤å…³ç³»ç½‘ç»œ</h1>
      <div id="relation-graph"></div>
      <div id="tooltip" class="tooltip"></div>
    </main>
  </div>

  <script>
    // èŠ‚ç‚¹å’Œè¾¹æ•°æ®
    var nodes = [
      { name: "å¾å…¶é›", image: "images/xqy.jpg", intro: "xqy ä¸€åæœ‰æ€æƒ³çš„å­¦ç”Ÿ" },
      { name: "zf", image: "images/hh.jpg", intro: "zf ä¸€ä¸ªæ¼‚äº®çš„å¥³å­©å­" },
      { name: "å¼ é‡Œ", image: "images/wh.jpg", intro: "ä¸€åè´Ÿè´£çš„è€å¸ˆ" },
      { name: "ssm", image: "images/zsk.jpg", intro: "ä¸€ä¸ªå¤§å‚»é€¼" },
      { name: "cyb", image: "images/cyb.jpg", intro: "å®éªŒå®¤å­¦å§" },
      { name: "lyw", image: "images/wzh.jpg", intro: "lywæ˜¯ä¸€ä¸ªdiaomao" },
      { name: "zrr", image: "images/wxy.jpg", intro: "zrrç»™ä»–åŠå¼ æ¯•ä¸šè¯" },
      { name: "xbl", image: "images/tq.jpg", intro: "xblæ˜¯ä¸€ä¸ªç“¦åŒå­¦" },
      { name: "wjj", image: "images/hj.jpg", intro: "wjjæ˜¯22çº§çš„ä¼ å¥‡äººç‰©" },
      { name: "tjl", image: "images/lxj.jpg", intro: "tjlæ˜¯æˆ‘çš„å®¤å‹" },
      { name: "ayx", image: "images/fy.jpg", intro: "ayxæ˜¯21çº§è‡ªåŠ¨åŒ–ä¸“ä¸šç¥å¥‡å­¦å§" },
      { name: "yjy", image: "images/zy.jpg", intro: "yjyæ˜¯21çº§ç”µå­1ç­çš“å­¦é•¿" }
    ];
    // è¾¹å…³ç³»
    var edges = [
      { source: 0, target: 1, relation: "é«˜ä¸­åŒå­¦&æƒ…ä¾£" },
      { source: 0, target: 9, relation: "å®¤å‹" },
      { source: 0, target: 2, relation: "æœ‹å‹" },
      { source: 0, target: 3, relation: "æœ‹å‹" },
      { source: 0, target: 4, relation: "æœ‹å‹" },
      { source: 0, target: 5, relation: "æœ‹å‹" },
      { source: 0, target: 6, relation: "æœ‹å‹" },
      { source: 0, target: 7, relation: "æœ‹å‹" },
      { source: 0, target: 8, relation: "æœ‹å‹" },
      { source: 0, target: 10, relation: "æœ‹å‹" },
      { source: 0, target: 11, relation: "æœ‹å‹" },

      { source: 2, target: 0, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 3, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 4, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 5, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 6, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 7, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 8, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 9, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 10, relation: "å¸ˆç”Ÿ" },
      { source: 2, target: 11, relation: "å¸ˆç”Ÿ" },

      { source: 4, target: 5, relation: "æƒ…ä¾£" },
      { source: 11, target: 10, relation: "å–œæ¬¢" }
    ];

    // ç”»å¸ƒè®¾ç½®
    var width = 900, height = 550, img_w = 56, img_h = 56, radius = 29;
    var svg = d3.select("#relation-graph").append("svg")
      .attr("width", width)
      .attr("height", height);

    var force = d3.layout.force()
      .nodes(nodes).links(edges)
      .size([width, height])
      .linkDistance(170)
      .charge(-950)
      .start();

    // tooltip
    var tooltip = d3.select("#tooltip");

    // ç®­å¤´
    var defs = svg.append("defs");
    var arrowMarker = defs.append("marker")
      .attr("id", "arrow")
      .attr("markerUnits", "strokeWidth")
      .attr("markerWidth", 12)
      .attr("markerHeight", 12)
      .attr("viewBox", "0 0 12 12")
      .attr("refX", 19).attr("refY", 6)
      .attr("orient", "auto");
    arrowMarker.append("path")
      .attr("d", "M2,2 L10,6 L2,10 L6,6 L2,2")
      .attr("fill", "#1abc9c");

    // è¾¹ï¼ˆpathï¼‰åŠ å”¯ä¸€idï¼Œä¾›textPathå¼•ç”¨
    var path = svg.selectAll(".edges")
      .data(edges).enter()
      .append("path")
      .attr("class", "edges")
      .attr("id", function(d, i){ return "edgepath" + i; })
      .attr("marker-end", "url(#arrow)");

    // å…³ç³»æ ‡ç­¾
    var pathtext = svg.selectAll(".pathText")
      .data(edges)
      .enter()
      .append("text")
      .attr("class", "pathText")
      .append("textPath")
      .attr("text-anchor", "middle")
      .attr("startOffset", "55%")
      .attr("xlink:href", function (d, i) { return "#edgepath" + i; })
      .text(function (d) { return d.relation; });

    // èŠ‚ç‚¹å¤´åƒ
    var circles = svg.selectAll(".forceCircle")
      .data(nodes)
      .enter()
      .append("circle")
      .attr("class", "forceCircle")
      .attr("r", radius)
      .attr("fill", function (d, i) {
        // åˆ›å»ºåœ†å½¢å›¾ç‰‡
        var patId = "circleimg" + i;
        var defs = svg.select("defs");
        var pattern = defs.append("pattern")
          .attr("id", patId)
          .attr("patternUnits", "objectBoundingBox")
          .attr("width", 1)
          .attr("height", 1);
        pattern.append("image")
          .attr("x", 0)
          .attr("y", 0)
          .attr("width", img_w)
          .attr("height", img_h)
          .attr("xlink:href", d.image);
        return "url(#" + patId + ")";
      })
      .on("mouseover", function (d, i) {
        // é«˜äº®è‡ªå·±å’Œç›¸å…³è¿çº¿
        d3.select(this).classed("highlight", true);
        path.classed("highlight", function(e){ return e.source===d||e.target===d; });
        tooltip.style("opacity", 1)
          .html("<strong>" + d.name + "</strong><br>" + d.intro);
      })
      .on("mousemove", function () {
        tooltip.style("left", (d3.event.pageX+20)+"px")
               .style("top", (d3.event.pageY-15)+"px");
      })
      .on("mouseout", function (d) {
        d3.select(this).classed("highlight", false);
        path.classed("highlight", false);
        tooltip.style("opacity", 0);
      })
      .call(force.drag);

    // å§“åæ ‡ç­¾
    var texts = svg.selectAll(".forceText")
      .data(nodes)
      .enter()
      .append("text")
      .attr("class", "forceText")
      .attr("dx", "-1.7em")
      .attr("dy", "3.1em")
      .text(function (d) { return d.name; });

    force.on("tick", function () {
      path.attr("d", function (d) {
        return "M" + d.source.x + "," + d.source.y + "L" + d.target.x + "," + d.target.y;
      });
      circles.attr("cx", function (d) { return d.x; });
      circles.attr("cy", function (d) { return d.y; });
      texts.attr("x", function (d) { return d.x; });
      texts.attr("y", function (d) { return d.y; });
    });
  </script>

     <div class="music-bar">
            <div style="color:#1abc9c;font-size:1rem;font-weight:600;">
                ğŸµ èƒŒæ™¯éŸ³ä¹ï¼š
            </div>
            <audio id="audioElement" src="./music/æ«.mp3" controls autoplay loop></audio>
        </div>
    </div>

</body>
</html>
